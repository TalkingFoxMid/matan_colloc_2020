# 9. Формула Ньютона–Лейбница для непрерывной функции. Формула Ньютона–Лейбница для функции, имеющей конечное число точек разрыва.
###### tags: `Матан-колоквиум`

## Формула Ньютона-Лейбница

Формула Ньютона-Лейбница даёт соотношение между двумя операциями: взятием интеграла Римана и вычислением первообразной.


\begin{equation}
\int_{a}^{b} f(x) d x=\left.\mathcal{F}(x)\right|_{a} ^{b}
\end{equation}

### Доказательство
Пусть $S(x)$ и $F(x)$ – две первообразных функции $f(x)$, то существует такое число $C$, что выполнено равенство:

$$
S(x)=F(x)+C
$$

Воспользовавшись предыдущим равенством равенством и определением интеграла с переменным верхним пределом **(8 билет)**, получаем:

$$
\int_{a}^{x} f(t) d t=F(x)+C
$$    **(1)**

Подставим значение $x = a$:
$$
\int_{a}^{a} f(t) d t=F(a)+C
$$

Заметим, что:

$$
\int_{a}^{a} f(t) d t=0
$$

Следовательно:
$$F(a)+C=0$$
$$C=-F(a)$$

Подставим переременную $C$ в **(1)** уравнение:
$$
\int_{a}^{x} f(t) d t=F(x)-F(a)
$$

Доказано.



## Формула Ньютона–Лейбница для функции, имеющей конечное число точек разрыва

#### **(Для ограниченной функции)**

Пусть функция $f(x)$ интегрируема на отрезке $[а,Ь]$ и $F$ — такая функция, что $F^{\prime}(x)=f(x)$ всюду на $[а, Ь]$, за исключением, конечного числа внутренних точек $c_{i}(i=1,2, \dots, p)$ и концов отрезка $а$ и $b$, где функция $F$ терпит разрывы первого рода. 
Тогда справедлива формула:
$$
\int_{a}^{b} f(x) d x=F(b-0)-F(a+0)-\sum_{i=1}^{p}\left(F\left(c_{i}+0\right)-F\left(c_{i}-0\right)\right)
$$

### Доказательство

Рассмотрим непрерывную на каждом из отрезков $\left[c_{i}, c_{i+1}\right]$ функцию:

$$
F_{1}(x)=\left\{\begin{array}{ll}
F(x), & x \in\left(c_{i}, c_{i+1}\right) \\
F\left(c_{i}+0\right), & x=c_{i}, \quad(i=1,2, \dots, p) ; c_{0}=a, c_{p+1}=b \\
F\left(c_{i+1}-0\right), & x=c_{i+1}
\end{array}\right.
$$

Возьмем произвольное разбиение $T: a=x_{0}<x_{1}<\ldots<x_{n}=b$ отрезка $[а,b]$, такое чтобы точки $c_{i}, i=1,2, \dots, p$, входили в число точек разбиения. 
Тогда, с одной стороны:

$$
\sum_{k=0}^{n-1}\left(F_{1}\left(x_{k+1}\right)-F_{1}\left(x_{k}\right)\right)=\sum_{k=0}^{n-1} F_{1}^{\prime}\left(\xi_{k}\right) \Delta x_{k}=\sum_{k=0}^{n-1} f\left(\xi_{k}\right) \Delta x_{k}
$$
**(1)**

где $\xi_{k} \in\left(x_{k}, x_{k+1}\right)$ (по теореме Лагранжа о конечных приращениях). 
С другой стороны:

$$
\begin{array}{c}
\sum_{k=0}^{n-1}\left(F_{1}\left(x_{k+1}\right)-F_{1}\left(x_{k}\right)\right)=\sum_{i=0}^{p}\left(F_{1}\left(c_{k+1}\right)-F_{1}\left(c_{k}\right)\right)= \\
=F_{1}\left(c_{1}\right)-F_{1}\left(c_{0}\right)+F_{1}\left(c_{p+1}\right)-F_{1}\left(c_{p}\right)+\sum_{i=1}^{p-1}\left(F\left(c_{i+1}-0\right)-F\left(c_{i}+0\right)\right)=
\end{array}
$$

$$
\begin{array}{c}
=F(b-0)-F(a+0)+F\left(c_{1}-0\right)-F\left(c_{p}+0\right)+\sum_{i=1}^{p-1}\left(F\left(c_{i+1}-0\right)-F\left(c_{i}+0\right)\right)= \\
=F(b-0)-F(a+0)+F\left(c_{1}-0\right)-F\left(c_{1}+0\right)+F\left(c_{2}-0\right)-F\left(c_{2}+0\right)+ \\
+F\left(c_{3}-0\right)-F\left(c_{3}+0\right)+\ldots+F\left(c_{p}-0\right)-F\left(c_{p}+0\right)= \\
=F(b-0)-F(a+0)-\sum_{i=0}^{p}\left(F\left(c_{i}+0\right)-F\left(c_{i}-0\right)\right)
\end{array}
$$
> Происходит полный треш. Попробую объяснить. $c_0$ это как бы начало отрезка, то есть $a$. $c_{p+1}$ соответственно $b$. Первым действием мы раскрываем сумму и сокращаются все элементы суммы, кроме тех, где функция берется от $c_i$. Именно поэтому останется сумма по всем отрезкам вида $[c_i, c_{i+1}]$, где $i: 0 \to p+1
В общем: чтобы понять эту дичь -- нужно попробовать проделать всё это своими руками $.


**(2)**

Переходя к пределу, устремив диаметр разбиения $d_\tau$ к нулю, из формулы **(1)** получаем (интегральная сумма):

$$
\lim _{d_\tau \rightarrow 0} \sum_{k=0}^{n-1}\left(F_{1}\left(x_{k+1}\right)-F_{1}\left(x_{k}\right)\right)=\int_{a}^{b} f(x) d x
$$

Сопоставляя полученный результат с формулой **(2)**, приходим к выводу, что:

$$
\int_{a}^{b} f(x) d x=F(b-0)-F(a+0)-\sum_{i=1}^{p}\left(F\left(c_{i}+0\right)-F\left(c_{i}-0\right)\right)
$$

Теорема доказана.

Замечание.
Разность $F\left(c_{i}+0\right)-F\left(c_{i}-0\right)$ есть величина скачка значений функции $F$ в точках разрыва.











